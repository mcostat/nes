{% extends "base/template.html" %}

{% load i18n static %}

{% block form %}
    
    <form id="user_form" method="post" data-bs-toggle="validator" enctype="multipart/form-data">
    {% csrf_token %}
{% endblock %}

{% block content %}

    {% comment %} {% if messages %}
        {% for message in messages %}

            {% if message.tags == "success" %}
                <script>showSuccessMessage('{{ message }}')</script>
            {% endif %}

            {% if message.tags == "warning" %}
                <script>showWarningMessage('{{ message }}')</script>
            {% endif %}

            {% if message.tags == "error" %}
                <script>showErrorMessage('{{ message }}')</script>
            {% endif %}

            {% if message.tags == "info" %}
                <script>showInfoMessage('{{ message }}')</script>
            {% endif %}

        {% endfor %}
    {% endif %} {% endcomment %}

    {% if position_form.errors %}
        <script type="text/javascript">
            showErrorMessage(gettext('Please, correct fields highlighted.'))
        </script>
    {% endif %}

    <div class="tab-pane fade show active" id="breadCrumb">
        <nav aria-label="breadcrumb">
            <ol class="breadcrumb">
                <li class="breadcrumb-item"><a href="/home">{% trans "Home" %}</a></li>
                <li class="breadcrumb-item"><a href="/experiment/eeg_electrode_localization_system/list">{% trans "EEG electrode localization system" %}</a></li>

                {% if creating %}
                    <li class="breadcrumb-item"><a href="/experiment/eeg_electrode_localization_system/{{ localization_system.id }}">{{ localization_system.name }}</a></li>
                {% else %}
                    <li class="breadcrumb-item"><a href="/experiment/eeg_electrode_localization_system/{{ position.eeg_electrode_localization_system.id }}">{{ position.eeg_electrode_localization_system.name }}</a></li>
                {% endif %}

                {% if creating %}
                    <li class="breadcrumb-item active">{% trans "New electrode coordinates" %}</li>
                {% else %}
                    {% if editing %}
                        <li class="breadcrumb-item"><a href="/experiment/eeg_electrode_position/{{ position.id }}">{{ position.name }}</a></li>
                        <li class="breadcrumb-item active">{% trans "Editing" %}</li>
                    {% else %}
                        <li class="breadcrumb-item active"> {{ position.name }} </li>
                    {% endif %}
                {% endif %}
            </ol>
        </nav>
    </div>

{% endblock %}

{% block subcontent %}

    <div id="electrode_position" class="tab-pane fade show active">

        <div hidden="hidden">
            <input id="map_file" type="text" value="{{ localization_system.map_image_file.url }}">
        </div>

        <div style="width:100%;">
            <table>
                <tr>
                    <td width="80%">
                        <div style="float:left; width: 80%">
                            <canvas id="electrodeMapCanvas" width="700" height="500" style="border:1px solid #000000;">
                            </canvas>
                        </div>
                    </td>

                    <td width="20%" valign="top">
                        <label class="form-label" style="margin-left: 10px;">{% trans "Electrode Cap Coordinates" %}</label>
                        <br/>

                        <table id="cap_positions" class="table table-striped header-fixed" style="margin-top:10px; margin-left:10px;">
                            <thead>
                            <tr>
                                <th>{% trans "Coordinates X - Y" %} </th>
                            </tr>
                            </thead>
                            <tbody>
                            {% for position in localization_system.electrode_positions.all %}
                                <tr>
                                    <td>
                                        {{ position.coordinate_x }}

                                        {{ position.coordinate_y }}
                                    </td>
                                </tr>
                            {% endfor %}
                            </tbody>
                        </table>

                    </td>

                </tr>
            </table>

        </div>
    </div>

{% endblock %}

{% block end_form %}
    </form>
{% endblock %}

{% block extrascript %}
    <script src="{% static 'site/js/eeg_electrode_cap_coordinates.js' %}"></script>
{% endblock %}